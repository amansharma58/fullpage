<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fullscreen Example</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
 <div class="container-fluid">
    <div class="fullscreen-page">
        <a href="#" onclick="enterFullscreen()"><img src="sample-1.jpg" width="600"></a>
<div class="fullscreen-container" id="fullscreenContainer">
    <div class="container">
        <h1 class="emoji">
            :(
        </h1>
        <p>Your device just ran into a problem and needs to restart</p>
        <img src="qrcode.svg" class="qrcode">
        <div id="waveform"></div>
        <!-- <audio id="fullscreenAudio" controls autoplay loop>
            <source src="a538e993-0faa-488d-b820-ac0a2f9e7815_04-03-25_19-4.wav" type="audio/mp3">
            Your browser does not support the audio element.
        </audio> -->
        <button class="exit-button" onclick="exitFullscreen()">Close</button>
    </div>
</div>
    </div>
 </div>
</body>
<script type="text/javascript" src="script.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/wavesurfer.js@6.0.0/dist/wavesurfer.min.js"></script>
<script>
    const wavesurfer = WaveSurfer.create({
        container: '#waveform',  // The container where the waveform will be drawn
        waveColor: '#3498db',    // Color of the waveform
        progressColor: '#2980b9',  // Color of the progress
        height: 150,             // Height of the waveform
        barWidth: 3,             // Width of the individual bars
        responsive: true,        // Make it responsive to window resizing
        loopSelection: true,     // Enable looping of selection (optional, if you want to loop the entire audio)
      });
  
      // Load a default audio file or a sample if available
      function loadDefaultAudio() {
        // Set the loading message
        document.getElementById('loadingMessage').style.display = 'block';
        wavesurfer.load('example.mp3');
  
        // Listen for the waveform's ready event and hide the loading message
        wavesurfer.on('ready', function() {
          document.getElementById('loadingMessage').style.display = 'none';
  
          // Automatically start playing when the audio is ready
          wavesurfer.play();
  
          // Set loop behavior: this ensures the audio loops once it reaches the end
          wavesurfer.on('finish', function() {
            wavesurfer.seekTo(0); // Go to the start
            wavesurfer.play();    // Start playing again
          });
        });
  
        // Error handling in case the audio file cannot be loaded
        wavesurfer.on('error', function() {
          document.getElementById('loadingMessage').innerText = 'Failed to load audio. Please check the file.';
        });
      }
  
      // Load default audio
      loadDefaultAudio();
  
      // Play/Pause functionality
      document.getElementById('playPauseButton').addEventListener('click', function() {
        if (wavesurfer.isPlaying()) {
          wavesurfer.pause();
          this.innerHTML = 'Play';
        } else {
          wavesurfer.play();
          this.innerHTML = 'Pause';
        }
      });
  
      // Upload functionality to load custom audio file
      document.getElementById('uploadAudio').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(event) {
            // Show the loading message when the user uploads a file
            document.getElementById('loadingMessage').style.display = 'block';
  
            // Load the file into WaveSurfer
            wavesurfer.loadBlob(event.target.result);
  
            // Hide the loading message once the audio file is loaded
            wavesurfer.on('ready', function() {
              document.getElementById('loadingMessage').style.display = 'none';
  
              // Automatically start playing when the audio is ready
              wavesurfer.play();
  
              // Set loop behavior for the uploaded audio as well
              wavesurfer.on('finish', function() {
                wavesurfer.seekTo(0); // Go to the start
                wavesurfer.play();    // Start playing again
              });
            });
  
            // Error handling
            wavesurfer.on('error', function() {
              document.getElementById('loadingMessage').innerText = 'Failed to load audio. Please check the file.';
            });
          };
          reader.readAsArrayBuffer(file);
        }
      });
</script>
</html>